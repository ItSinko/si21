<html>
<head>
<title>SPA (Offline) Tambah</title>
</head>
<style>
	
				/*Untuk form aks */
input[id=noproduk]{
    width: 7%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 90px;
    left: 170px;
	
	}
		
				/*Untuk form aks */
input[id=nolkpp]{
  
   width: 15%;
    padding:  12px 12px 12px 70px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 150px;
    left: 170px;
	
	}
		
				/*Untuk form aks */
select[id=distributor]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 210px;
  
	left: 170px;
	}
	

				/*Untuk form aks */
select[id=type]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 270px;
    left: 170px;

	}
		
				/*Untuk form aks */
textarea[id=nama]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 330px;
    left: 170px;
	
	}
		
	
				/*Untuk form aks */
input[id=harga]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 90px;
    left: 600px;
	
	}
	
				/*Untuk form aks */
input[id=jumlah]{
    width: 7%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 150px;
    left: 600px;
	
	}	
					/*Untuk form aks */
input[id=ongkir]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 210px;
    left: 600px;

	}	
						/*Untuk form aks */
input[id=total]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 270px;
    left: 600px;
	
	}	
	
	
							/*Untuk form aks */
input[id=instansi]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 90px;
    left: 1000px;
	
	}	
								/*Untuk form aks */

	
	
	
									/*Untuk form aks */
select[id=status]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 145px;
    left: 1000px;

	}


input[id=tgl]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 200px;
    left: 1000px;

	}


textarea[id=ket]{
    width: 15%;
    padding: 12px 20px;
    margin: 10px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
	position: absolute;
	top: 260px;
    left: 1000px;
	
	}	
	
	
	          	/*Untuk label samping */
    .no{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 110px;
    left:60px;
   }
   	          	/*Untuk label samping */
    .nolkpp{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 170px;
    left:60px;
   }
   
   
      	          	/*Untuk label samping */
    .off{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 170px;
    left:195px;
   }
   
       	          	/*Untuk label samping */
    .off2{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 290px;
    left:195px;
   }
      
      
      	          	/*Untuk label samping */
    .distributor{
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	font-size:14px;
   	position: absolute;
	top: 230px;
    left:60px;
   }
        	          	/*Untuk label samping */
    .noaks{
	font-size:14px;
	font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;   
   position: absolute;
	top: 290px;
    left:60px;
   }
         	          	/*Untuk label samping */
    .type{
font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 290px;
    left:60px;
   }
            	          	/*Untuk label samping */
    .nama{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 350px;
    left:60px;
   }
               	          	/*Untuk label samping */
    .harga{
font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 110px;
    left:480px;
   }
                 	          	/*Untuk label samping */
    .jumlahunit{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 170px;
    left:480px;
   }
                	          	/*Untuk label samping */
    .ongkir{
font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 230px;
    left:480px;
   }
                	          	/*Untuk label samping */
    .total{
	font-size:14px;
   		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	position: absolute;
	top: 290px;
    left:480px;
   }
               	          	/*Untuk label samping */
    .insta{
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	font-size:14px;
   	position: absolute;
	top: 110px;
    left:900px;
   }               	          	/*Untuk label samping */
    .satuan{
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	font-size:14px;
   	position: absolute;
	top: 170px;
    left:900px;
   }          	          	/*Untuk label samping */
    .deskripsi{
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	font-size:14px;
   	position: absolute;
	top: 230px;
    left:900px;
   }          	          	/*Untuk label samping */
    .status{
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	font-size:14px;
   	position: absolute;
	top: 165px;
    left:900px;
   }
        	/*Untuk label samping */
    .tgl{
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	font-size:14px;
   	position: absolute;
	top: 220px;
    left:900px;
   }
   
       	/*Untuk label samping */
    .ket{
	font-size:14px;
   	position: absolute;
		font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
	top: 280px;
    left:900px;
   }
   
.form-style-3 fieldset{
	border-radius: 10px;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	margin: 0px 0px 10px 0px;
	border: 1px solid #FFD2D2;

	width:26%;
	height:50%;
	position: absolute;
	top: 80px;
    left:30px;
	background: #FFF4F4;
	box-shadow: inset 0px 0px 15px #FFE5E5;
	-moz-box-shadow: inset 0px 0px 15px #FFE5E5;
	-webkit-box-shadow: inset 0px 0px 15px #FFE5E5;
}

.form-style-3 fieldset legend{
	color: #00000;
	border-top: 1px solid #FFD2D2;
	border-left: 1px solid #FFD2D2;
	border-right: 1px solid #FFD2D2;
	border-radius: 5px 5px 0px 0px;
	-webkit-border-radius: 5px 5px 0px 0px;
	-moz-border-radius: 5px 5px 0px 0px;
	background: #FFF4F4;
	padding: 0px 8px 3px 8px;
	box-shadow: -0px -1px 2px #F1F1F1;
	-moz-box-shadow:-0px -1px 2px #F1F1F1;
	-webkit-box-shadow:-0px -1px 2px #F1F1F1;
	font-weight: normal;
	font-size: 12px;
}



.form-style-4 fieldset{
	border-radius: 10px;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	margin: 0px 0px 10px 0px;
	border: 1px solid #FFD2D2;

	width:26%;
	height:50%;
	position: absolute;
	top: 80px;
    left:450px;
	background: #FFF4F4;
	box-shadow: inset 0px 0px 15px #FFE5E5;
	-moz-box-shadow: inset 0px 0px 15px #FFE5E5;
	-webkit-box-shadow: inset 0px 0px 15px #FFE5E5;
}

.form-style-5 fieldset{
	border-radius: 10px;
	-webkit-border-radius: 10px;
	-moz-border-radius: 10px;
	margin: 0px 0px 10px 0px;
	border: 1px solid #FFD2D2;

	width:25%;
	height:50%;
	position: absolute;
	top: 80px;
    left:868px;
	background: #FFF4F4;
	box-shadow: inset 0px 0px 15px #FFE5E5;
	-moz-box-shadow: inset 0px 0px 15px #FFE5E5;
	-webkit-box-shadow: inset 0px 0px 15px #FFE5E5;
}

/*Untuk tombol Submit */
button[type=submit] {
    width: 8%;
   	background: #5e3beb;
    box-shadow: inset -1px -1px 3px #FF62A7;
	-moz-box-shadow: inset -1px -1px 3px #FF62A7;
	-webkit-box-shadow: inset -1px -1px 3px #FF62A7;
		border-radius: 3px;
	border-radius: 3px;
	-webkit-border-radius: 3px;
	-moz-border-radius: 3px;
	color: white;
    padding: 10px 10px;
    margin: 8px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
	position: absolute;
	top: 512px;
    left: 450px;
	}

/*Untuk tombol Submit */
button[type=batal] {
    width: 8%;
   	background: #EB3B88;
    box-shadow: inset -1px -1px 3px #FF62A7;
	-moz-box-shadow: inset -1px -1px 3px #FF62A7;
	-webkit-box-shadow: inset -1px -1px 3px #FF62A7;
		border-radius: 3px;
	border-radius: 3px;
	-webkit-border-radius: 3px;
	-moz-border-radius: 3px;
	color: white;
    padding: 10px 10px;
    margin: 8px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
	position: absolute;
	top: 512px;
    left: 710px;
	}

/*Untuk tombol Submit */
input[type=submit] {
    width: 8%;
   	background:#556B2F;
    box-shadow: inset -1px -1px 3px #FF62A7;
	-moz-box-shadow: inset -1px -1px 3px #FF62A7;
	-webkit-box-shadow: inset -1px -1px 3px #FF62A7;
		border-radius: 3px;
	border-radius: 3px;
	-webkit-border-radius: 3px;
	-moz-border-radius: 3px;
	color: white;
    padding: 10px 10px;
    margin: 8px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
	position: absolute;
	top: 332px;
    left: 600px;
	}
	
	
		
input[id=diskonspa]{
display: none;
	               }	
	
	
	input[id=diskonujispa]{
display: none;
                      }	
	
	
	input[id=expdates]{
display: none;
	
	}	
	
	
	input[id=idprod_on]{
display: none;
	               }	
	
	
	input[id=idrate2_on]{
display: none;
                      }	
	
	
	input[id=pabrik_on]{
display: none;
	
	}	
	
		
</style>
<body onchange="rp()">

<div class="form-style-3">
<fieldset>
<legend>Info Produk</legend>
</fieldset>

<form action="proses_tambah.php" method="post">


<?php 
//kode generate nomer otomatis
$con = mysqli_connect("localhost","root","","kontrol_db");
$que= "SELECT max(no_off) as macoo FROM spa_off";
$hasilnya = mysqli_query($con,$que);
$data = mysqli_fetch_array($hasilnya);
$nomercoo = $data['macoo'];

//convert to int
$nourut = (int)($nomercoo);

//plus
$nourut++;

//format string
$newID = sprintf("%01s",$nourut);


?>

<input type="number" id="noproduk" name="no_off" placeholder="id"  value="<?php echo $newID; ?>" readonly>

<input type="text" id="nolkpp" name="idorder_off" placeholder="" required>

<select type="text" id="distributor" name="pabrik"  placeholder="distri">
<option value="disabled">Pilih Distributor</option>
                <?php
				$con= mysqli_connect("localhost","root","","kontrol_db");
                $query = mysqli_query($con,"SELECT * FROM distributor ORDER by pabrik   ");
                while ($row = mysqli_fetch_array($query)) {
                ?>
                    <option value="<?php echo $row['pabrik']; ?>"><?php echo $row['pabrik']; ?></option>
                <?php
                }
                ?>

</select>


<select type="text" id="type" onchange="changeValue(this.value);rp();harga();"   required>
<option value="disabled">Pilih Produk</option>

        <?php 
		$con=mysqli_connect("localhost","root","","kontrol_db");
    $result = mysqli_query($con,"SELECT * FROM diskon_master INNER JOIN distributor
								ON distributor.iddsb=diskon_master.pabrikfk
								INNER JOIN produk_master ON produk_master.id_prod=diskon_master.idprodfk");    
    $jsArray = "var dtMhs = new Array();\n";        
    while ($row = mysqli_fetch_array($result)) {    
        echo '<option  class="'.$row['pabrik'].'"  value="' . $row['sing_prod'] . '">' . $row['sing_prod'] . '</option>';    
        $jsArray .= "dtMhs['" . $row['sing_prod'] . "'] = {nam_prod:'" . addslashes($row['nam_prod']) . "',
                                                       harga:'" . addslashes($row['harga']) . "',
														diskon:'" .addslashes($row['diskonnota'])."',
														diskonujispa:'" .addslashes($row['diskonuji'])."',
														exp:'" .addslashes($row['temphari'])."',
														idprod_on:'" .addslashes($row['id_prod'])."',
														idrate2_on:'" .addslashes($row['idrate2'])."',
														pabrik_on:'" .addslashes($row['iddsb'])."',
														
														};\n";
	} 
	
    ?> 
</select>


<textarea type="text" id="nama" placeholder="nama" readonly>
</textarea>


<div class="form-style-4">
<fieldset>
<legend>Info Harga</legend>
</fieldset>


<input type="text" id="harga"  name="harga_off" onkeyup="rp();count();"  class="harga" placeholder="harga" readonly >
<input type="number" id="jumlah" name="jumlah_off" class="jumlah" onkeyup="rp();count();" placeholder="jumlah">
<input type="text" id="ongkir" name="ongkos_off" class="ongkir" onkeyup="rp();count();" placeholder="ongkir">
<input type="text" id="total"  class="total" onkeyup="rp();count();" placeholder="total" readonly>

<div class="form-style-5">
<fieldset>
<legend>Info Pemesan</legend>
</fieldset>

<input type="text" name="pemesan_off" id="instansi" placeholder="Pemesan" required>


<select type="text" id="status" name="status_off" placeholder="satuan" required>
<option value="">Pilih Status</option>
<option value="Sepakat">Sepakat</option>
<option value="Masih Negosiasi">Masih Negosiasi</option>
</select>

<?php  
  date_default_timezone_set("Asia/Jakarta");  
  //Function untuk menset waktu ke waktu asia/jakarta  
  ?>
<input type="date" id="tgl" name="tgl_buat_off" value="<?php echo date('Y-m-d') ?>" readonly>

<textarea type="date" id="ket" name="ket_off" placeholder="keterangan">
</textarea>



<label class="no">No *</label>
<label class="nolkpp">ID Order *</label>
<label class="distributor">Distributor *</label>

<label class="type">Type Produk *</label>
<label class="nama">Nama Produk</label>
<label class="harga">Harga / Unit </label>
<label class="jumlahunit">Jumlah Unit *</label>
<label class="ongkir">Ongkos Kirim *</label>
<label class="total">Total Harga</label>
<label class="insta">Pemesan *</label>


<label class="status">Status Paket *</label>
<label class="tgl">Tgl Buat *</label>
<label class="ket">Keterangan</label>
<label class="off">OFF -</label>
</div>


<button type="submit" name="submit"  onclick="return confirm('Yakin Tambah Data ?');">Tambah</button>
<button type="batal" name="batal" formnovalidate  onclick="return confirm('Yakin Batal ?');" >Batal</button>


<!--hidden input -->
<input type="text" id="diskonspa" name="diskon_nota_off">
<input type="text" id="diskonujispa" name="diskon_uji_off" >
<input type="text" id="expdates" name="temphari_off">



 <!--hidden input foreign key-->
<input type="text" id="idprod_on" name="idprod_off">
<input type="text" id="idrate2_on" name="idrate2_off">
<input type="text" id="pabrik_on" name="pabrik_off">



</form>

</body>

 <script>
	  
	  function rp() {

            $('#harga').priceFormat({
                prefix: 'Rp  ',
                thousandsSeparator:'.',
                centsLimit: 0
            });
				
	    $('#ongkir').priceFormat({
                prefix: 'Rp  ',
                thousandsSeparator:'.',
                centsLimit: 0
            });
	  
	  
	  	  $('#total').priceFormat({
                prefix: 'Rp  ',
                thousandsSeparator:'.',
                centsLimit: 0
            });
	  
	  
	  }
	</script>

	
		<!-- JS nya Jquery -->
       <script src="jquery-1.10.2.min.js"></script>

        <!--  JS nya Jquery Price Format  -->
        <script type="text/javascript" src="jquery.price_format.2.0.js"></script>

		
		 <!--  JS nya Jquery Chained Format  -->
		<script src="jquery.chained.min.js"></script>
	
		
		<!--  JS nya Jquery Chained Format  -->
		
		 <script>
            $("#type").chained("#distributor");
         </script>
        		
		
<script type="text/javascript">    
    <?php echo $jsArray; 
	
	?>  
    
	function changeValue(sing_prod){  
    document.getElementById('nama').value = dtMhs[sing_prod].nam_prod;    
	document.getElementById('harga').value = dtMhs[sing_prod].harga;  
	document.getElementById('diskonspa').value = dtMhs[sing_prod].diskon;  
	document.getElementById('diskonujispa').value = dtMhs[sing_prod].diskonujispa;  	
	document.getElementById('expdates').value = dtMhs[sing_prod].exp;
	document.getElementById('idprod_on').value = dtMhs[sing_prod].idprod_on;
	document.getElementById('idrate2_on').value = dtMhs[sing_prod].idrate2_on;
	document.getElementById('pabrik_on').value = dtMhs[sing_prod].pabrik_on;	
	
	};  
    </script> 

	
<script>
           function count() {
                var harga 		= $(".harga").val();
				var jumlah		= $(".jumlah").val();
				var total		= $(".total").val();
				var ongkir		= $(".ongkir").val();
		
			   harga   = harga.split('Rp ').join('');
			   harga   = harga.split('.').join('');
                
			   ongkir   = ongkir.split('Rp ').join('');
			   ongkir   = ongkir.split('.').join('');

			   
			   total   = total.split('Rp ').join('');
			   total   = total.split('.').join('');

		total = Math.round(jumlah* harga)+(ongkir*1); 
     $(".total").val(total);
         }
            
</script>

	

</html>